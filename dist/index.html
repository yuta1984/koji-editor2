<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Koji Editorãƒ‡ãƒ¢</title>
    <script src="koji-editor.js"></script>
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.2/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.0/highlight.min.js"></script>
    <!-- and it's easy to individually load additional languages -->
    <script charset="UTF-8"
            src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.0/languages/xml.min.js"></script>
    <style>
      html,
      body {
        height: 100%;
        margin:0;  
        overflow: hidden;      
      }
      div.left, div.right {
        width: 48%;
        height: 100%;
        float: left;
        padding: 5px;
      }
      .Person, .Date, .Place{
        font-weight: bold;      
        color: crimson;
      }
      .Date::after{content:'â³'; font-size: 10px; margin: 2px 0 5px;}
      .Person::after{content:'ğŸ‘¤'; font-size: 10px;margin: 2px 0 5px; }
      .Place::after{content:'ğŸ“'; font-size: 10px; margin: 2px 0 5px; }
      .Cover{
        border: 1px solid black;
      }
      div.right{       
        padding: 5px;  
        height: 90%;        
      }
      div.display{
        height: 95%;
        width: 100%;
        overflow: scroll;
        border: 1px solid black;   
      }
      div.html{       
        writing-mode: vertical-rl;
        font-family: "æ¸¸æ˜æœ", YuMincho, "Hiragino Mincho ProN W3", "ãƒ’ãƒ©ã‚®ãƒæ˜æœ ProN W3", "Hiragino Mincho ProN", "HGæ˜æœE", "ï¼­ï¼³ ï¼°æ˜æœ", "ï¼­ï¼³ æ˜æœ", serif;
        display: block;       
      }
      .koji{padding: 5px;}
      #editor{
        height: 80%;        
        width: 100%;
      }

  .Furigana {
    
  }
  .Okurigana {    
    vertical-align: super;
    font-size: 8px;
  }
  .Kaeriten {    
    vertical-align: sub;
    font-size: 8px;
  }
  .Warigaki {
    display: inline-table;
    -webkit-writing-mode: vertical-lr;
    writing-mode: vertical-lr;
    -ms-writing-mode: vertical-rl;
    -moz-writing-mode: vertical-rl;
    vertical-align: top;
  }
  .warigaki-left,
  .warigaki-right {
    font-size: 50%;
    display: table-row;
    line-height: 150%;
  }
  .box {
    margin: 2px;
    border: 1px solid black;
    display: inline;
  }
  .Comment {
    color: red;
  }
  .Comment:before {
      content: "\1F4AC";
      font-size: 12px;
      margin: 5px 0 -5px;
    }
  .Illegible, .BugHole {
    background-color: yellow;   
  }  
  .Illegible:after {
      content: "\2753";
      font-size: 5px;
  }
  .BugHole:after {
      content: "ğŸ›";
      font-size: 5px;
  }
  .hljs {
  	white-space: pre-wrap;
  }
    </style>    
  </head>
  <body>
    <div class="left">
      <div id="editor"></div>
      <div class="buttons" style="padding: 5px;">
        ã‚µãƒ³ãƒ—ãƒ«ï¼š
        <button onclick="editor.value=src1">åœ°éœ‡å¹´ä»£è¨˜</button>
        <button onclick="editor.value=src2">å’Œæ¼¢æœ—è© é›†</button>
        <button onclick="editor.value=''">ç©ºç™½</button>
        <br>
        ã‚¿ã‚°æŒ¿å…¥ï¼š<button onclick="insertTitle()">é¡Œ</button>
        <button id="warigaki">å‰²æ›¸</button>
        <button id="date">æ—¥æ™‚</button>
        <button id="person" onclick="insertPerson()">äººç‰©</button>
        <button id="place" onclick="insertPlace()">å ´æ‰€</button>
        <button id="place" onclick="editor.insertOrReplace('â–¡')">é›£èª­</button>
        <button id="place" onclick="editor.insertOrReplace('â– ')">è™«æ</button>
        <button id="place" onclick="editor.insertOrReplace('ï¼¿ãƒ¬')">è¿”ã‚Šç‚¹</button>
        <button id="place" onclick="editor.insertOrReplace('ï¿£ã‚«ãƒŠ')">é€ã‚Šä»®å</button>
        <br>
        å³å´ã®è¡¨ç¤ºï¼š
        <select id="content" name="content" onchange="displayChanged(this)">
          <option value="html">HTML</option>
          <option value="xml">XML</option>          
          <option value="legend">å‡¡ä¾‹</option>
        </select>     
        <button onclick="toggleDisabled()">ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ç„¡åŠ¹åŒ–ï¼æœ‰åŠ¹åŒ–</button>        
      </div>
    </div>
    <div class="right">
      <div class="display html"></div>      
      <div class="display xml" style="display: none;"></div>
      <div class="display legend" style="display: none;">
        <iframe style="width:100%; height:100%;" frameborder="0" src="http://honkoku.org/tutorial.html" ></iframe>    

      </div>
    </div>
    <script>
      const src1 = `ï¼…è¡¨ç´™
å®‰æ”¿äºŒæ”¹æ­£
å¤§æ—¥æœ¬ç¥ä»£ãƒ¨ãƒªã€€ã€€ã€Šå›²ã„æ›¸ãï¼šç¦å£² ã€‹
ã€Šé¡Œï¼šåœ°éœ‡å¹´ä»£è¨˜ã€‹
æµªèŠ±ã€€æ–‡éº—å ‚è—æ¿

ï¼…åºæ–‡
ï¼œã“ã¨ã—å®‰æ”¿äºŒå¹´å¯åæœˆäºŒæ—¥ï¼äººå®šï¼ˆã«ã‚“ã¦ã„ï¼‰ã«ã„ãŸã‚Šå¸Œæœ‰ï¼ˆã‘ã†ï¼‰ã®å¤§åœ°å‹•ï¼ˆãŠã»ã¢ã—ã‚“ï¼‰ã‚ã‚Šå€‰å±‹ï¼ˆã•ã†ã‚’ã‚„ï¼‰æ‚‰ï¼ˆã“ã¨ã€³ã€µï¼‰ãæï¼ˆãã“ãªï¼‰ã¯ã‚Œ
äººç•œï¼ˆã«ã‚“ã¡ãï¼‰ã®å‚·é«”ï¼ˆã‘ãŒï¼‰è¨±å¤šï¼ˆã‚ã¾ãŸï¼‰ãªã‚Œã°è²´è³ï¼ˆãã›ã‚“ï¼‰ä¸Šä¸‹ç¥ï¼ˆãŸã¾ã—ã²ï¼‰ã‚’å¤±ï¼ˆã†ã—ãªï¼‰ã²ææ€–ï¼ˆãã‚ˆã†ãµï¼‰ã›ã–ã‚‹ã‚‚ã®ãªã—ã—ã‹ã‚‹ã«åï¼ˆãªï¼‰
ã ã‚ã‚‹ç¥ç¤¾ä½›é–£ï¼ˆã—ã‚“ã˜ã‚„ãµã¤ã‹ãï¼‰ã«ã„ãŸã‚Šã¦ã¯åã«ä¹ãƒ„æ™ï¼ˆã¤ã¤ãŒï¼‰ãªãã¯å¥‡ï¼ˆã‚ã‚„ï¼‰ã—ãã‚‚ã„ã¨å°Šï¼ˆãŸãµã¨ï¼‰ã—ä»°ï¼ˆã‚ãµï¼‰ã‹ã–ã‚‰ã‚ã‚„
æ•¬ï¼ˆã‘ã„ï¼‰ã›ã–ã‚‰ã‚ã‚„ã€Šå²æ–™ï¼šåŸƒåš¢éˆ”ï¼ˆã‚ã„ã®ã†ã›ã†ï¼‰ã€Šå‰²æ›¸ï¼šåå››ï½œå·»ã€‹ã€‹ã«åœ°éœ‡å‹•ã®å‰å‡¶ï¼ˆãã¤ãã‚ˆã†ï¼‰ã‚’çŸ¥ï¼ˆã—ï¼‰ã‚‹æ³•ï¼ˆã»ã†ï¼‰ã‚’è¼‰ï¼ˆã®ã›ï¼‰ãŸã‚Šã“ã‚Œã«ã‚ˆã‚‹ã«ã€Šæ—¥æ™‚ï¼šåæœˆ
äºŒæ—¥ã€‹ã¯äºŒåå…«å®¿ã®è™šå®¿ï¼ˆãã‚‡ã—ã‚†ãï¼‰ã«å€¤ï¼ˆã‚ã¸ï¼‰ã‚Šæ™‚ï¼ˆã¨ãï¼‰ã¯ï¼œäº¥åˆ»ï¼ˆã‚ã®ã“ãï¼‰ï¼ãªã‚Šä½›èª¬ï¼ˆã¶ã¤ã›ã¤ï¼‰ã«æ­¤æ—¥æ­¤æ™‚ã®åœ°éœ‡ï¼ˆã¢ã—ã‚“ï¼‰ã‚’å¸é‡ˆå‹•ï¼ˆãŸã„ã—ã‚„ãã‚†ã‚Šï¼‰ã¨
ç§°ï¼ˆã¨ãªï¼‰ã¸ã¦å…¶å¾´ï¼ˆãã®ã—ã‚‹ã—ï¼‰ã¯å¤©ä¸‹ï¼ˆã¦ã‚“ã‹ï¼‰å®‰ç©©ï¼ˆã‚ã‚“ãŠã‚“ï¼‰äº”ç©€ï¼ˆã”ã“ãï¼‰è±Šé¥’ï¼ˆã¶ã­ã†ï¼‰å¤©å­ï¼ˆã¦ã‚“ã—ï¼‰å‰å¤§è‡£ï¼ˆãã¤ã ã„ã˜ã‚“ï¼‰ç¦ï¼ˆãµãï¼‰ã‚’å—ï¼ˆã†ã‘ï¼‰ä¸‡æ°‘ï¼ˆã¯ã‚“ã¿ã‚“ï¼‰å®‰ç©©ï¼ˆã‚ã‚“ã‚’ã‚“ï¼‰ä¹Ÿï¼ˆãªã‚Šï¼‰ã¨ã—ã‚‹ã›ã‚Šç«ç¥å‹•ï¼ˆãã‚ã˜ã‚“ã‚†ã‚Šï¼‰
é¾ç¥å‹•ï¼ˆã‚Šã†ã˜ã‚“ã‚†ã‚Šï¼‰é‡‘ç¿…é³¥å‹•ï¼ˆã“ã‚“ã—ã¦ã†ã‚†ã‚Šï¼‰ã¨éœ‡å‹•ï¼ˆã¢ã—ã‚“ï¼‰ã«å››ç¨®ï¼ˆã—ã—ã‚†ï¼‰ã‚ã‚‹äº‹ å¤§æ™ºåº¦è«–ï¼ˆãŸã„ã¡ã©ã‚ã‚“ï¼‰ã«å‡ºã¦å¸é‡ˆå‹•ï¼ˆãŸã„ã—ã‚„ãã‚†ã‚Šï¼‰ã®å¤–ï¼ˆã»ã‹ï¼‰ã¯çš†ï¼ˆã¿ãªï¼‰å‡¶å…†ï¼ˆãã‚ˆã†ã¦ã†ï¼‰ãªã‚Šå¤§
é¯°ï¼ˆãªã¾ã¥ï¼‰ã®æ‰€ç‚ºï¼ˆã‚ã–ï¼‰ã¨ã„ãµã‚‚é‡‘ç¿…é³¥å‹•ï¼ˆã“ã‚“ã—ã¦ã†ã‚†ã‚Šï¼‰ã®é¡ï¼ˆãŸãã²ï¼‰ãªã‚‹ã¹ã—å…”ï¼ˆã¨ï¼‰ã«ã‚‚è§’ï¼ˆã‹ãï¼‰ã«ã‚‚ã„ã¨ã‚ã¦ãŸãä¸–ç›´ï¼ˆã‚ˆãªã»ï¼‰ã—ã«ã“ãæ­¤ä¸€å°å†Šï¼ˆã“ã®ã„ã¤ã›ã†ã•ã¤ï¼‰ã¯
ä¸Šä»£ï¼ˆã˜ã‚„ã†ã ã„ï¼‰ã‚ˆã‚Šã®åœ°éœ‡ï¼ˆã¢ã—ã‚“ï¼‰ã‚’å¤ä»Šï¼ˆã“ã“ã‚“ï¼‰ã®æ›¸ç±ï¼ˆã—ã‚ˆã¢ã‚„ãï¼‰ã‚ˆã‚Šéˆ”ç•¥ï¼ˆã›ã†ã‚Šã‚„ãï¼‰å–è©®ï¼ˆã—ã‚†ã›ã‚“ï¼‰ã—ã¦ä»Šåº¦ï¼ˆã“ã‚“ã©ï¼‰ã®ã«ã„ãã‚‰ã‚‚å‹ï¼ˆã¾ã•ï¼‰ã‚‹åœ°éœ‡ æ•°ååº¦ï¼ˆã™ã˜ãµã©ï¼‰
ã‚ã‚Šã—ã‹ã©ä¸–ï¼ˆã‚ˆï¼‰ã®è¡°ç˜ï¼ˆã™ã‚ã¸ã„ï¼‰ã™ã‚‹ã«ã‚‚ã‚ã‚‰ãšå¼¥æ „ï¼ˆã„ã‚„ã•ã‹ï¼‰ãˆã«ã•ã‹ãˆã¦å¤©åœ°ï¼ˆã‚ã‚ã¤ã¡ï¼‰ã¨å…±ï¼ˆã¨ã‚‚ï¼‰ã«çª®ï¼ˆãã¯ã¾ï¼‰ã‚Šãªãæˆ‘è‘¦åŸï¼ˆã‚ãŒã‚ã—ã¯ã‚‰ï¼‰
ã®ä¸­å›½ï¼ˆãªã‹ã¤ãã«ï¼‰ã®æ³°å¹³ï¼ˆãŸã„ã¸ã„ï¼‰ä¸‡ã€…æ­³ï¼ˆã°ã‚“ã€³ã€µãœã„ï¼‰ãŸã‚‹ã‚ˆã—ã‚’äººã€…ã«çŸ¥ï¼ˆã—ï¼‰ã‚‰ã›å‚ï¼ˆã¾ã‚ï¼‰ã‚‰ã›ã‚“ã¨ã¦
ï½›ç„¡åæ°è­˜ï½`;
      const src2=`
ã€Šé¡Œï¼šæ˜¥ã€€ç«‹æ˜¥ã€‹

ï¼…æ¼¢è©©
é€ï¼ˆãƒ²ãƒ„ï¼‰ï¿£ãƒ†ï¼¿ãƒ¬å¹ï¼ˆã‚«ã‚»ï¼‰ï¿£ãƒ²æ½›ï¿£ã‚«ãƒ‹é–‹ï¿£ã‚¯ä¸ï¼ˆã‚¹ï¼‰ï¼¿ãƒ¬å¾…ï¿£ã‚¿ï¼¿äºŒèŠ³ï¼ˆãƒã‚¦ï¼‰è²ï¼ˆãƒ’ï¼‰ï¿£ãƒä¹‹å€™ï¼ˆã‚³ã‚¦ï¼‰ï¿£ãƒ²ï¼¿ä¸€ã€€è¿ï¼ˆãƒ ã‚«ãƒ˜ï¼‰ï¿£ãƒ†ï¼¿ãƒ¬æ˜¥ï¿£ãƒ²ä¹ï¼ˆã‚¿ãƒãƒï¼‰ï¿£ãƒå¤‰ï¿£ã‚¹
å°†ï¿£ã‚¹ï¼¿ãƒ¬å¸Œï¿£ãƒãƒ³ï¼¿äºŒé›¨éœ²ï¿£ãƒä¹‹æ©ï¿£ãƒ²ï¼¿ä¸€ã€€ã€Šå‰²æ›¸ï¼šå†…å®´ï¿£ãƒ‹é€²ï¼¿ãƒ¬èŠ±è³¦ç´€ï¿£ãƒï½œå”æœ›ï½›å…¬ä¹—å„„ ï½ã€‹

ï¼…æ¼¢è©©
æ± ï¿£ãƒå‡ï¿£ãƒæ±é ­ï¿£ãƒé¢¨ åº¦ï¼ˆãƒ¯ã‚¿ãƒ„ï¼‰ï¿£ãƒ†è§£ï¿£ã‚±çª“ï¿£ãƒæ¢…ï¿£ãƒåŒ—é¢ãƒé›ªå°ï¿£ã‚·ãƒ†å¯’ï¿£ã‚·ã€€ã€Šå‰²æ›¸ï¼šç«‹æ˜¥ï¿£ãƒæ—¥ï¿£ãƒæ›¸æ‡ å‘ˆï¿£ã‚¹ï¼¿äºŒ èŠ¸é–£è«¸åˆ†å‹ï¼¿ä¸€ã€‹ã€€ï½›ç¯¤èŒ‚ï½

ï¼…å’Œæ­Œ
å¹´ã®ã†ã¡ã«æ˜¥ã¯ãã«ã‘ã‚Šã²ã¨ã‚ã›ã‚’
ã€€ã€€ã“ãã¨ã‚„ã„ã¯ã‚“ã“ã¨ã—ã¨ã‚„ã„ã¯ã‚“ã€€ï½›å…ƒæ–¹ ï½

ï¼…æ¼¢è©©
æŸ³ç„¡ï¿£ã‚·ï¼¿äºŒæ°—åŠ›ï¼¿ä¸€æ¡ï¼ˆã‚¨ãƒ€ï¼‰å…ˆï¼ˆãƒãƒ…ï¼‰å‹•ï¿£ã‚­æ± ï¿£ãƒ‹æœ‰ï¼¿äºŒæ³¢ï¿£ãƒæ–‡ï¼¿ä¸€æ°·ç›¡ï¿£ã‚¯é–‹ï¿£ã‚¯ã€€ã€”åºœè¥¿æ± ã€•ã€€ï½›ç™½ï½

ï¼…æ¼¢è©©
ä»Šæ—¥ä¸ï¼¿ãƒ¬çŸ¥ï¿£ãƒ©èª°ï¿£ã‚«è¨ˆæœƒï¿£ã‚»ãƒ³ã€€æ˜¥é¢¨æ˜¥æ°´ä¸€æ™‚ï¿£ãƒ‹æ¥ï¼ˆã‚­ï¼‰ï¿£ã‚¿ãƒ©ãƒ³ãƒˆã€€ã€”åºœè¥¿æ± ã€•ã€€ï½›ç™½ ï½`;
      const parent = document.getElementById('editor');
      const editor = new KojiEditor.Editor(parent, "ã“ã“ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã—ã¾ã™");
      editor.watch('renderedText', (store)=>{
        if (editor.renderingMode === 'html'){
          const right = document.querySelector('.html')
          right.innerHTML = editor.renderedText
        } else if (editor.renderingMode === 'xml') {
          const right = document.querySelector('.xml')          
          console.log(editor.renderedText)
          right.innerText = `${editor.renderedText}`;
          hljs.highlightBlock(right);
        }        
      })
      const warigaki = document.querySelector('#warigaki');
      const date = document.querySelector('#date');
      warigaki.addEventListener('click', () => {
        editor.insertOrReplace('ã€Šå‰²æ›¸ï¼šä¸€è¡Œç›®ï½œäºŒè¡Œç›®ã€‹');
      });
      date.addEventListener('click', () => {
        editor.markup('ï¼œ', 'ï¼');
      });
      function insertPerson(){
        editor.markup('ï½›', 'ï½');
      }
      function insertPlace(){
        editor.markup('ã€”', 'ã€•');
      }
      function insertTitle(){
        editor.markup('ã€Šé¡Œï¼š', 'ã€‹');
      }
      function toggleDisabled(){
        editor.disabled = !editor.disabled
      }
      function displayChanged(selection){
        const idx = selection.selectedIndex;
        const value = selection.options[idx].value;
        if (value === 'html' || value === 'xml') editor.renderingMode = value;
        const display = document.querySelector(`.display.${value}`);
        display.style.display = 'block';
        const hidden = document.querySelectorAll(`.display:not(.${value})`);
        hidden.forEach(elem => elem.style.display = 'none');
      }
    </script>
  </body>
</html>
